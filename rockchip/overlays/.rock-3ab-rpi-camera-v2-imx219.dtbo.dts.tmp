# 1 "arch/arm64/boot/dts/rockchip/overlays/rock-3ab-rpi-camera-v2-imx219.dts"
# 1 "<built-in>"
# 1 "<command-line>"
# 1 "arch/arm64/boot/dts/rockchip/overlays/rock-3ab-rpi-camera-v2-imx219.dts"

/dts-v1/;
/plugin/;

# 1 "./scripts/dtc/include-prefixes/dt-bindings/gpio/gpio.h" 1
# 6 "arch/arm64/boot/dts/rockchip/overlays/rock-3ab-rpi-camera-v2-imx219.dts" 2
# 1 "./scripts/dtc/include-prefixes/dt-bindings/pinctrl/rockchip.h" 1
# 7 "arch/arm64/boot/dts/rockchip/overlays/rock-3ab-rpi-camera-v2-imx219.dts" 2

/ {
 metadata {
  title = "Enable Raspberry Pi Camera v2";
  compatible = "radxa,rock-3a", "radxa,rock-3b";
  category = "camera";
  exclusive = "csi2_dphy0";
  description = "Enable Raspberry Pi Camera v2.";
 };
};

&{/} {
 ext_cam_clk_imx219: ext-cam-clk-imx219 {
  status = "okay";
  compatible = "fixed-clock";
  clock-frequency = <24000000>;
  clock-output-names = "ext_cam_clk_imx219";
  #clock-cells = <0>;
 };

 vcc_camera: vcc-camera {
  status = "okay";
  compatible = "regulator-fixed";
  regulator-name = "vcc_camera";
  gpio = <&gpio1 9 0>;
  enable-active-high;
  regulator-min-microvolt = <3300000>;
  regulator-max-microvolt = <3300000>;
  regulator-always-on;
  regulator-boot-on;
 };

 camera_pwdn_gpio: camera-pwdn-gpio {
  status = "okay";
  compatible = "regulator-fixed";
  regulator-name = "camera_pwdn_gpio";
  regulator-always-on;
  regulator-boot-on;
  enable-active-high;
  gpio = <&gpio4 26 0>;
 };
};

&i2c5 {
 status = "okay";
 pinctrl-names = "default";
 pinctrl-0 = <&i2c5m0_xfer>;
 #address-cells = <1>;
 #size-cells = <0>;

 camera_imx219: camera-imx219@10 {
  status = "okay";
  compatible = "sony,imx219";
  reg = <0x10>;
  clocks = <&ext_cam_clk_imx219>;
  clock-names = "xvclk";
  rockchip,camera-module-index = <0>;
  rockchip,camera-module-facing = "front";
  rockchip,camera-module-name = "rpi-camera-v2";
  rockchip,camera-module-lens-name = "default";

  port {
   imx219_out: endpoint {
    remote-endpoint = <&mipi_in_ucam1>;
    data-lanes = <1 2>;
   };
  };
 };
};

&csi2_dphy_hw {
 status = "okay";
};

&csi2_dphy0 {
 status = "okay";

 ports {
  #address-cells = <1>;
  #size-cells = <0>;

  port@0 {
   reg = <0>;
   #address-cells = <1>;
   #size-cells = <0>;

   mipi_in_ucam1: endpoint@2 {
    reg = <2>;
    remote-endpoint = <&imx219_out>;
    data-lanes = <1 2>;
   };
  };

  port@1 {
   reg = <1>;
   #address-cells = <1>;
   #size-cells = <0>;

   dphy0_out: endpoint@1 {
    reg = <1>;
    remote-endpoint = <&isp0_in>;
   };
  };
 };
};

&rkisp_vir0 {
 status = "okay";

 port {
  #address-cells = <1>;
  #size-cells = <0>;

  isp0_in: endpoint@0 {
   reg = <0>;
   remote-endpoint = <&dphy0_out>;
  };
 };
};

&rkisp {
 status = "okay";
};

&rkisp_mmu {
 status = "okay";
};

&rkcif_mmu {
 status = "okay";
};

&rkcif {
 status = "okay";
};
